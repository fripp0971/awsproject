{"filter":false,"title":"template.yaml","tooltip":"/order-app/template.yaml","undoManager":{"mark":52,"position":52,"stack":[[{"start":{"row":13,"column":2},"end":{"row":27,"column":0},"action":"remove","lines":["HelloWorldFunction:","    Type: AWS::Serverless::Function # More info about Function Resource: https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction","    Properties:","      CodeUri: hello-world/","      Handler: app.lambdaHandler","      Runtime: nodejs14.x","      Architectures:","        - x86_64","      Events:","        HelloWorld:","          Type: Api # More info about API Event Source: https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#api","          Properties:","            Path: /hello","            Method: get",""],"id":3}],[{"start":{"row":15,"column":2},"end":{"row":27,"column":0},"action":"remove","lines":["# ServerlessRestApi is an implicit API created out of Events key under Serverless::Function","  # Find out more about other implicit resources you can reference within SAM","  # https://github.com/awslabs/serverless-application-model/blob/master/docs/internals/generated_resources.rst#api","  HelloWorldApi:","    Description: \"API Gateway endpoint URL for Prod stage for Hello World function\"","    Value: !Sub \"https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/hello/\"","  HelloWorldFunction:","    Description: \"Hello World Lambda Function ARN\"","    Value: !GetAtt HelloWorldFunction.Arn","  HelloWorldFunctionIamRole:","    Description: \"Implicit IAM Role created for Hello World function\"","    Value: !GetAtt HelloWorldFunctionRole.Arn",""],"id":4}],[{"start":{"row":7,"column":0},"end":{"row":8,"column":0},"action":"remove","lines":["# More info about Globals: https://github.com/awslabs/serverless-application-model/blob/master/docs/globals.rst",""],"id":5}],[{"start":{"row":11,"column":10},"end":{"row":12,"column":0},"action":"insert","lines":["",""],"id":6}],[{"start":{"row":12,"column":0},"end":{"row":29,"column":0},"action":"insert","lines":["  OrderTable:","    Type: AWS::DynamoDB::Table","    Properties: ","      TableName: order-table","      AttributeDefinitions: ","        - AttributeName: user_id","          AttributeType: S","        - AttributeName: id","          AttributeType: S","      KeySchema: ","        - AttributeName: user_id","          KeyType: HASH","        - AttributeName: id","          KeyType: RANGE","      ProvisionedThroughput: ","        ReadCapacityUnits: 5","        WriteCapacityUnits: 5",""],"id":7}],[{"start":{"row":31,"column":8},"end":{"row":32,"column":0},"action":"insert","lines":["",""],"id":8}],[{"start":{"row":32,"column":0},"end":{"row":34,"column":26},"action":"insert","lines":["DynamoDBTableName:","    Description: \"DynamoDB Table Name\"","    Value: !Ref OrderTable"],"id":9}],[{"start":{"row":32,"column":0},"end":{"row":32,"column":2},"action":"insert","lines":["  "],"id":10}],[{"start":{"row":33,"column":2},"end":{"row":33,"column":4},"action":"remove","lines":["  "],"id":11}],[{"start":{"row":33,"column":2},"end":{"row":33,"column":4},"action":"insert","lines":["  "],"id":12}],[{"start":{"row":28,"column":29},"end":{"row":29,"column":0},"action":"insert","lines":["",""],"id":13},{"start":{"row":29,"column":0},"end":{"row":29,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":29,"column":6},"end":{"row":29,"column":8},"action":"remove","lines":["  "],"id":14},{"start":{"row":29,"column":4},"end":{"row":29,"column":6},"action":"remove","lines":["  "]},{"start":{"row":29,"column":2},"end":{"row":29,"column":4},"action":"remove","lines":["  "]}],[{"start":{"row":29,"column":2},"end":{"row":30,"column":0},"action":"insert","lines":["",""],"id":15},{"start":{"row":30,"column":0},"end":{"row":30,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":30,"column":2},"end":{"row":56,"column":0},"action":"insert","lines":["  GetOrders:","    Type: AWS::Serverless::Function ","    Properties:","      CodeUri: src/order-api/functions/get-orders/","      Handler: app.getOrders","      Runtime: nodejs14.x","      Environment:","        Variables:","          ORDER_TABLE: !Ref OrderTable","      Policies:","        Statement:","          - Effect: Allow","            Action:","              - dynamodb:GetItem","              - dynamodb:Query ","              - dynamodb:Scan","            Resource:","              - !Sub ","                - 'arn:aws:dynamodb:*:*:table/${Table}'","                - { Table: !Ref OrderTable }","          - Effect: Allow","            Action:","              - logs:*","            Resource:","              - \"*\"    ","",""],"id":16}],[{"start":{"row":30,"column":2},"end":{"row":30,"column":4},"action":"remove","lines":["  "],"id":17}],[{"start":{"row":62,"column":26},"end":{"row":63,"column":0},"action":"insert","lines":["",""],"id":18},{"start":{"row":63,"column":0},"end":{"row":63,"column":4},"action":"insert","lines":["    "]},{"start":{"row":63,"column":4},"end":{"row":64,"column":0},"action":"insert","lines":["",""]},{"start":{"row":64,"column":0},"end":{"row":64,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":64,"column":2},"end":{"row":64,"column":4},"action":"remove","lines":["  "],"id":19}],[{"start":{"row":64,"column":2},"end":{"row":67,"column":0},"action":"insert","lines":["  GetOrders:","    Description: \"GetOrders Lambda Function ARN\"","    Value: !GetAtt GetOrders.Arn",""],"id":20}],[{"start":{"row":64,"column":2},"end":{"row":64,"column":4},"action":"remove","lines":["  "],"id":21}],[{"start":{"row":56,"column":0},"end":{"row":101,"column":0},"action":"insert","lines":["  OrderApi:","    Type: AWS::Serverless::Api","    Properties:","      StageName: Dev","      Cors:","        AllowMethods: \"'POST, GET, UPDATE, DELETE'\"","        AllowHeaders: \"'X-Forwarded-For'\"","        AllowOrigin: \"'*'\"","        MaxAge: \"'600'\"","      DefinitionBody:","        'Fn::Transform':","          Name: 'AWS::Include'","          Parameters:","            Location: './api.yaml'","","  ApiGwExecutionRole: ","    Type: \"AWS::IAM::Role\"","    Properties: ","      AssumeRolePolicyDocument: ","        Version: \"2012-10-17\"","        Statement: ","          - ","            Effect: \"Allow\"","            Principal: ","              Service: ","                - \"apigateway.amazonaws.com\"","                - \"lambda.amazonaws.com\"","            Action: ","              - \"sts:AssumeRole\"","      Path: \"/\"","","  ApiGwExecutionPolicy: ","    Type: \"AWS::IAM::Policy\"","    Properties: ","      PolicyName: \"apigw-execution-policy\"","      PolicyDocument: ","        Version: \"2012-10-17\"","        Statement: ","          Action:","            - lambda:*","          Effect: Allow","          Resource:","            - !GetAtt GetOrders.Arn","      Roles: ","        - Ref: \"ApiGwExecutionRole\"",""],"id":22}],[{"start":{"row":112,"column":0},"end":{"row":113,"column":0},"action":"insert","lines":["",""],"id":23}],[{"start":{"row":113,"column":0},"end":{"row":116,"column":0},"action":"insert","lines":["  OrderApiEndpoint:","    Description: \"API Gateway endpoint URL for Dev stage for Order Get function\"","    Value: !Sub \"https://${OrderApi}.execute-api.${AWS::Region}.amazonaws.com/Dev/orders/\"",""],"id":24}],[{"start":{"row":54,"column":6},"end":{"row":55,"column":0},"action":"insert","lines":["",""],"id":25},{"start":{"row":55,"column":0},"end":{"row":55,"column":6},"action":"insert","lines":["      "]},{"start":{"row":55,"column":6},"end":{"row":56,"column":0},"action":"insert","lines":["",""]},{"start":{"row":56,"column":0},"end":{"row":56,"column":6},"action":"insert","lines":["      "]},{"start":{"row":56,"column":6},"end":{"row":57,"column":0},"action":"insert","lines":["",""]},{"start":{"row":57,"column":0},"end":{"row":57,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":54,"column":6},"end":{"row":55,"column":6},"action":"remove","lines":["","      "],"id":27},{"start":{"row":54,"column":4},"end":{"row":54,"column":6},"action":"remove","lines":["  "]}],[{"start":{"row":54,"column":4},"end":{"row":55,"column":4},"action":"remove","lines":["","    "],"id":28}],[{"start":{"row":54,"column":4},"end":{"row":55,"column":4},"action":"remove","lines":["  ","    "],"id":29}],[{"start":{"row":102,"column":0},"end":{"row":103,"column":0},"action":"insert","lines":["",""],"id":30}],[{"start":{"row":102,"column":0},"end":{"row":103,"column":0},"action":"insert","lines":["",""],"id":31}],[{"start":{"row":103,"column":0},"end":{"row":126,"column":0},"action":"insert","lines":["  PostOrders:","    Type: AWS::Serverless::Function ","    Properties:","      CodeUri: src/order-api/functions/post-orders/","      Handler: app.postOrders","      Runtime: nodejs14.x","      Environment:","        Variables:","          ORDER_TABLE: !Ref OrderTable","      Policies:","        Statement:","          - Effect: Allow","            Action:","              - dynamodb:PutItem","            Resource:","              - !Sub ","                - 'arn:aws:dynamodb:*:*:table/${Table}'","                - { Table: !Ref OrderTable }","          - Effect: Allow","            Action:","              - logs:*","            Resource:","              - \"*\"    ",""],"id":32}],[{"start":{"row":142,"column":2},"end":{"row":145,"column":0},"action":"insert","lines":["  PostOrders:","    Description: \"PostOrders Lambda Function ARN\"","    Value: !GetAtt PostOrders.Arn",""],"id":33}],[{"start":{"row":142,"column":2},"end":{"row":142,"column":4},"action":"remove","lines":["  "],"id":34}],[{"start":{"row":98,"column":35},"end":{"row":99,"column":0},"action":"insert","lines":["",""],"id":35},{"start":{"row":99,"column":0},"end":{"row":99,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":98,"column":12},"end":{"row":98,"column":35},"action":"remove","lines":["- !GetAtt GetOrders.Arn"],"id":36},{"start":{"row":98,"column":12},"end":{"row":98,"column":35},"action":"insert","lines":["- !GetAtt GetOrders.Arn"]}],[{"start":{"row":98,"column":35},"end":{"row":99,"column":0},"action":"insert","lines":["",""],"id":37},{"start":{"row":99,"column":0},"end":{"row":99,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":99,"column":12},"end":{"row":99,"column":35},"action":"insert","lines":["- !GetAtt GetOrders.Arn"],"id":38}],[{"start":{"row":99,"column":22},"end":{"row":99,"column":25},"action":"remove","lines":["Get"],"id":39},{"start":{"row":99,"column":22},"end":{"row":99,"column":23},"action":"insert","lines":["P"]},{"start":{"row":99,"column":23},"end":{"row":99,"column":24},"action":"insert","lines":["o"]},{"start":{"row":99,"column":24},"end":{"row":99,"column":25},"action":"insert","lines":["s"]}],[{"start":{"row":99,"column":25},"end":{"row":99,"column":26},"action":"insert","lines":["'"],"id":40}],[{"start":{"row":99,"column":25},"end":{"row":99,"column":26},"action":"remove","lines":["'"],"id":41}],[{"start":{"row":99,"column":25},"end":{"row":99,"column":26},"action":"insert","lines":["t"],"id":42}],[{"start":{"row":128,"column":0},"end":{"row":129,"column":0},"action":"insert","lines":["",""],"id":43}],[{"start":{"row":129,"column":0},"end":{"row":152,"column":0},"action":"insert","lines":["  GetSingleOrder:","    Type: AWS::Serverless::Function ","    Properties:","      CodeUri: src/order-api/functions/get-single-order/","      Handler: app.getOrderById","      Runtime: nodejs14.x","      Environment:","        Variables:","          ORDER_TABLE: !Ref OrderTable","      Policies:","        Statement:","          - Effect: Allow","            Action:","              - dynamodb:GetItem","            Resource:","              - !Sub ","                - 'arn:aws:dynamodb:*:*:table/${Table}'","                - { Table: !Ref OrderTable }","          - Effect: Allow","            Action:","              - logs:*","            Resource:","              - \"*\"    ",""],"id":44}],[{"start":{"row":171,"column":0},"end":{"row":172,"column":0},"action":"insert","lines":["",""],"id":45}],[{"start":{"row":172,"column":0},"end":{"row":175,"column":0},"action":"insert","lines":["  GetSingleOrder:","    Description: \"GetSingleOrder Lambda Function ARN\"","    Value: !GetAtt GetSingleOrder.Arn",""],"id":46}],[{"start":{"row":99,"column":36},"end":{"row":100,"column":0},"action":"insert","lines":["",""],"id":47},{"start":{"row":100,"column":0},"end":{"row":100,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":100,"column":12},"end":{"row":100,"column":13},"action":"insert","lines":["-"],"id":48},{"start":{"row":100,"column":13},"end":{"row":100,"column":14},"action":"insert","lines":["!"]},{"start":{"row":100,"column":14},"end":{"row":100,"column":15},"action":"insert","lines":["-"]}],[{"start":{"row":100,"column":14},"end":{"row":100,"column":15},"action":"remove","lines":["-"],"id":49},{"start":{"row":100,"column":13},"end":{"row":100,"column":14},"action":"remove","lines":["!"]}],[{"start":{"row":100,"column":13},"end":{"row":100,"column":14},"action":"insert","lines":[" "],"id":50},{"start":{"row":100,"column":14},"end":{"row":100,"column":15},"action":"insert","lines":["G"]},{"start":{"row":100,"column":15},"end":{"row":100,"column":16},"action":"insert","lines":["e"]},{"start":{"row":100,"column":16},"end":{"row":100,"column":17},"action":"insert","lines":["t"]}],[{"start":{"row":100,"column":14},"end":{"row":100,"column":17},"action":"remove","lines":["Get"],"id":51},{"start":{"row":100,"column":14},"end":{"row":100,"column":20},"action":"insert","lines":["GetAtt"]}],[{"start":{"row":100,"column":14},"end":{"row":100,"column":15},"action":"insert","lines":["!"],"id":52}],[{"start":{"row":100,"column":21},"end":{"row":100,"column":22},"action":"insert","lines":[" "],"id":53},{"start":{"row":100,"column":22},"end":{"row":100,"column":23},"action":"insert","lines":["G"]},{"start":{"row":100,"column":23},"end":{"row":100,"column":24},"action":"insert","lines":["e"]},{"start":{"row":100,"column":24},"end":{"row":100,"column":25},"action":"insert","lines":["t"]}],[{"start":{"row":100,"column":22},"end":{"row":100,"column":25},"action":"remove","lines":["Get"],"id":54},{"start":{"row":100,"column":22},"end":{"row":100,"column":36},"action":"insert","lines":["GetSingleOrder"]}],[{"start":{"row":100,"column":36},"end":{"row":100,"column":37},"action":"insert","lines":["."],"id":55},{"start":{"row":100,"column":37},"end":{"row":100,"column":38},"action":"insert","lines":["A"]}],[{"start":{"row":100,"column":37},"end":{"row":100,"column":38},"action":"remove","lines":["A"],"id":56},{"start":{"row":100,"column":37},"end":{"row":100,"column":40},"action":"insert","lines":["Arn"]}]]},"ace":{"folds":[],"scrolltop":1337,"scrollleft":0,"selection":{"start":{"row":100,"column":40},"end":{"row":100,"column":40},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":22,"state":"start","mode":"ace/mode/yaml"}},"timestamp":1662230147217,"hash":"1e8b836b8f88fdfa68b219577454c3a920f70e6e"}